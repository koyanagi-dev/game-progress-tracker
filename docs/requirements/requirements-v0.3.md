# Game Progress Tracker 要件定義書（ライト版）

- バージョン: v0.3
- 対象アプリ: Game Progress Tracker（ゲーム進捗管理 TODO アプリ）
- 想定開発方式: 個人開発（趣味）＋アジャイル（小さく作って小さく改善）

---

## 1. アプリ概要

### 1.1 目的

- RPG などのゲームプレイにおける以下の情報を整理・管理することを目的とした Web アプリ。
  - クエストの進行状況
  - 装備・アイテムの収集状況
  - レベル上げ・素材集めなどの作業タスク
- 抜け漏れ防止、やることの見える化、モチベーション維持をサポートする。

### 1.2 対象ユーザー

- 主に 1 人でゲームをプレイする一般ユーザー（ゲーマー）。
- PC ブラウザで Web アプリを開けるユーザー。
- 現時点では「自分用の管理ツール」としての利用を想定。
  - 将来的な「フレンドとの共有」などは拡張候補。

---

## 2. 用語定義

- **タスク**  
  ゲーム内で行うべきことの単位（例: 「○○ダンジョン攻略」「レベル 50 まで育成」など）。

- **状態（ステータス）**  
  タスクの進行状況。
  - 未着手（not-started）
  - 進行中（in-progress）
  - 完了（completed）
  - 保留（on-hold）

- **カテゴリ**  
  タスクの種類や目的を表す分類（例: メインクエスト、サブクエスト、ボス攻略 など）。

---

## 3. 機能要件

### 3.1 タスク管理（基本）

#### 3.1.1 タスク追加

- テキスト入力欄＋「追加」ボタンで新しいタスクを登録できる。
- 初期状態：
  - 状態: 「未着手」
  - カテゴリ: 選択されたもの（詳細は 3.2 参照）
- 入力バリデーション：
  - 入力文字列を `trim` した結果が空文字の場合は **追加しない**。
  - 最大文字数：100 文字
    - 100 文字を超えた場合は、100 文字までに切り詰めて扱う。

#### 3.1.2 タスク一覧表示

- 登録されたタスクはカード形式で一覧表示される。
- 表示内容：
  - タスク名
  - 状態（日本語表示: 未着手／進行中／完了／保留）
  - 進捗ゲージ（状態に応じて 0〜100%）
  - カテゴリラベル（3.2.3 参照）
- カードごとに以下の操作ボタンを表示：
  - 「✏️ 編集」
  - 「🔄 状態変更」
  - 「❌ 削除」

#### 3.1.3 状態変更

- 各タスクごとに「🔄 状態変更」ボタンがあり、クリックするごとに状態がローテーションする。
- ローテーション順：
  - 未着手 → 進行中 → 完了 → 保留 → 未着手 …
- 状態に応じて以下が変化する：
  - 状態ラベル（日本語）
  - カードの背景色・文字色
  - 進捗ゲージの長さ

#### 3.1.4 タスク編集

- 各タスクで「✏️ 編集」ボタンを押すと、そのタスク行が「編集モード」になる。
  - タスク名のテキスト部分が入力欄に変わる。
  - ボタンが「💾 保存」「↩️ キャンセル」に切り替わる。
- 「💾 保存」押下時：
  - 入力内容を `trim` した結果が空でない場合 → その内容でタスク名を更新。
  - 空文字 or 空白のみの場合 → タスク名は変更せず、編集モードのみ終了。
- 「↩️ キャンセル」押下時：
  - タスク名は一切変更せず、編集モードを解除する。

#### 3.1.5 タスク削除

- 各タスクに「❌ 削除」ボタンを表示する。
- ボタン押下でそのタスクを一覧から削除する。
- 削除されたタスクは localStorage からも消える（3.4 参照）。

---

### 3.2 カテゴリ機能（v0.3 で追加）

#### 3.2.1 カテゴリマスタ

- タスクには 1 つのカテゴリを紐づける。
- カテゴリは以下の固定リストから選択する：

  1. メインクエスト
  2. サブクエスト
  3. 装備・アイテム収集
  4. レベル上げ・育成
  5. 素材集め
  6. ボス攻略
  7. その他

- ユーザーがカテゴリを自由追加・編集する機能は **現時点では持たない**。
  - 将来の拡張候補として「ユーザー定義カテゴリ」を検討する。

#### 3.2.2 タスク追加時のカテゴリ選択

- タスク追加フォームにカテゴリ選択用のプルダウンを表示する。
- プルダウンの初期値は「メインクエスト」。
- タスク追加時に、選択されているカテゴリを `category` として保存する。
- バリデーション：
  - タスク名が空文字・空白のみの場合 → タスクは追加されない（カテゴリの値はそのまま保持）。
- 旧バージョン（カテゴリ機能導入前）のデータ：
  - localStorage から復元した際、`category` が未定義のタスクには `"その他"` を自動付与する。

#### 3.2.3 タスク一覧へのカテゴリ表示

- 各タスクカードにカテゴリラベルを表示する。
- 例：
  - 「[メインクエスト]」「[サブクエスト]」などのバッジ形式。
- カテゴリごとに色分けを行う（目視で区別できる程度でよい）。
- ラベルのクリックによるフィルタ等は **現時点では行わない**。

#### 3.2.4 カテゴリ絞り込み UI

- 画面中部にカテゴリ絞り込み用のプルダウンを設置する。
- 選択肢：
  - すべて
  - メインクエスト
  - サブクエスト
  - 装備・アイテム収集
  - レベル上げ・育成
  - 素材集め
  - ボス攻略
  - その他
- 動作仕様：
  - 「すべて」 → 登録されている全タスクを表示。
  - 上記カテゴリのいずれか → `category` が一致するタスクのみ表示。
- カテゴリ絞り込みは、状態ソート結果に対して後から絞り込みを行う。
  - ソート順自体は変えず、その順序の中からカテゴリでフィルタするイメージ。

---

### 3.3 並べ替え（状態ソート）

#### 3.3.1 並べ替え UI

- 画面上部に以下の 3 ボタンを設置する：
  - 「状態の昇順（未着手 → 保留）」
  - 「状態の降順（保留 → 未着手）」
  - 「並べ替え解除」
- 押下時の挙動：

#### 3.3.2 並べ替えロジック（B仕様）

- 昇順ボタン：
  - 現在のタスク一覧を「状態順（未着手→進行中→完了→保留）」で**一度だけ**ソートし、
  - その時点の並びを `sortedIds` として固定する。
- 降順ボタン：
  - 現在のタスク一覧を「状態順（保留→完了→進行中→未着手）」で**一度だけ**ソートし、
  - その時点の並びを `sortedIds` として固定する。
- その後、状態変更（ステータスローテーション）が行われても、**並び順は変化しない**。
  - これにより、ユーザーが一度並べ替えた順序が、操作のたびに揺れないようにする。
- 並べ替え中に新しく追加されたタスクは、ソート済みリストの末尾に追加される。
- 「並べ替え解除」：
  - `sortedIds` を破棄し、元の「追加順」で表示するモードに戻す。
  - 状態変更は引き続き可能。

---

### 3.4 永続化（localStorage）

#### 3.4.1 保存対象

- ブラウザの `localStorage` に次の情報を JSON として保存する：
  - id
  - text
  - status
  - category
  - （isEditing は UI 内部用の一時状態のため保存しない）

#### 3.4.2 保存タイミング

- タスク配列 `tasks` が更新されるたびに、全体を `localStorage` に上書き保存する。

#### 3.4.3 復元タイミング

- アプリ起動時（初回レンダリング時）に `localStorage` から読み込む。
- JSON 解析に失敗した場合、または配列でない場合は、エラーにせず「空のタスク一覧」として扱う。
- 古いバージョンのデータにも対応するよう、復元時に以下の補正を行う：
  - `id` が無い／不正 → 一意な ID を再割り当て。
  - `status` が不正 → `"not-started"` にフォールバック。
  - `category` が無い → `"その他"` を付与。
  - `text` → 文字列にキャスト。

---

### 3.5 バリデーション要件

- タスク追加：
  - `trim` 後に空の場合は追加しない。
  - 最大 100 文字。それ以上は 100 文字に切り詰め。
- タスク編集：
  - `trim` 後に空の場合は、名前を変更せず編集モードのみ解除。
- これらの仕様は UI テストで確認済み。

---

## 4. 非機能要件

### 4.1 対応ブラウザ

- 開発・動作確認の主対象：
  - デスクトップ版 Chrome 最新版
- 可能であれば、将来的に：
  - Edge / Firefox / Safari なども確認する。

### 4.2 パフォーマンス

- 数十〜数百件程度のタスクで快適に動作すること。
- 今回のスコープでは、数千件以上の大量データは考慮しない。

### 4.3 セキュリティ

- 現バージョンは **完全ローカルアプリ** とし、外部サーバーへの通信は行わない。
- 保存データはブラウザの localStorage 上に平文で保持される。
  - 利用端末が他人と共有される場合、ユーザー自身の操作（ブラウザの削除等）でデータを消せるようにしておくことが望ましい。
- 将来的にオンライン同期などを行う場合は、別途セキュリティ要件（認証・認可・暗号化等）を定義する。

---

## 5. 将来の拡張候補（メモ）

- ユーザー定義カテゴリ（カテゴリの追加・削除）
- タグ機能（カテゴリとは別の自由ラベル）
- 優先度（高・中・低）と、そのソート機能
- メモ欄（タスクごとの詳細説明）
- マルチデバイス同期（Firebase / Supabase 等のバックエンド連携）
- 共有機能（フレンドと進捗を共有する）

---

## 6. Kano モデル観点でのざっくり分類（参考）

- **当たり前品質（M）**
  - タスクの追加・削除・編集・状態管理
  - タスク一覧表示
  - 入力バリデーション（空文字禁止）
- **一元品質（O）**
  - 状態ソート（昇順／降順）
  - localStorage による永続化
  - カテゴリ選択・カテゴリ表示
  - カテゴリ絞り込み
  - 入力バリデーション（最大文字数制限：100文字）
- **魅力品質（A）**
  - カテゴリごとの色付きバッジ
  - ゲームっぽい UI（アイコン、カラーリング）
  - 並べ替え中に状態を変えても並びを固定する「使い心地」の良さ
