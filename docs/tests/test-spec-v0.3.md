# Game Progress Tracker テスト仕様メモ v0.3

## 0. ドキュメント情報

- ドキュメント名：Game Progress Tracker テスト仕様メモ
- バージョン：v0.3
- 更新日：2025-11-24
- 対象アプリ：Game Progress Tracker
- テストタイプ：自動テスト中心（Vitest + React Testing Library）

### 0.1 変更履歴

- v0.1：タスク追加／削除／編集／状態変更／ソートの基本テストを整理
- v0.2：カテゴリ機能（選択／絞り込み）、localStorage 永続化、入力バリデーション（空文字・最大長）を追加
- **v0.3：メモ機能（登録・編集）、削除取り消し（Undo）関連テストを追加し、Kano分類と要件ID（F-xx）と整合させた**

---

## 1. テスト方針（概要）

1. **ユニットテスト（ロジック単体）**
   - 対象：タスク配列操作ロジックなど（`src/tests/tasks.test.js`）
   - 目的：タスクの追加・削除・状態変更などのロジックが UI と独立して正しく動くことを担保する。

2. **UI テスト（コンポーネント動作）**
   - 対象：App コンポーネント（`App.jsx`）および UI 挙動
   - 実装：Vitest + React Testing Library
   - 目的：ユーザー操作（クリック／入力）が画面表示と状態に正しく反映されることを確認する。

3. **Kano モデルとの対応**
   - Must-be（当然品質）の要件は、基本的に **UIテスト＋必要に応じてユニットテスト** の両面でカバーする。
   - One-dimensional（魅力度が線形に上がる品質）は、主にユーザー目線の UI テストでカバーする。
   - 各テストケースは、対応する要件ID（F-xx）と Kano分類を明記する。

---

## 2. 前提条件

- 実行環境
  - `npm test` で Vitest を実行
  - Vite + React プロジェクト構成
- 主なテストライブラリ
  - Vitest
  - @testing-library/react
  - @testing-library/user-event

---

## 3. テスト観点一覧（機能別・Kano別）

### 3.1 Must-be（当たり前品質）

- F-01：タスク追加
- F-02：タスク一覧表示
- F-03：タスク編集（名前）
- F-04：タスク削除
- F-05：状態変更（ローテーション）
- F-11：入力バリデーション（空文字・最大長）
- F-12：localStorage 永続化

### 3.2 One-dimensional（一元品質）

- F-06：並べ替え（昇順／降順／解除）
- F-07：カテゴリ選択
- F-08：カテゴリ絞り込み
- F-09：メモ登録・表示
- F-10：メモ編集
- F-13：削除取り消し（Undo）

---

## 4. テストケース一覧（簡易版）

### 4.1 ユニットテスト（ロジック）

#### T-UNIT-001：タスク追加ロジック

- 対象要件：F-01（Must-be）
- 種別：ユニットテスト
- テストファイル：`src/tests/tasks.test.js`
- 観点：
  - 空の配列にタスクを追加すると、配列長が 1 になり、内容が正しく設定される。
  - 複数回追加した場合、追加順に配列へ格納される。

#### T-UNIT-002：タスク削除ロジック

- 対象要件：F-04（Must-be）
- 種別：ユニットテスト
- テストファイル：`src/tests/tasks.test.js`
- 観点：
  - 指定IDのタスクを削除した場合、そのタスクのみが配列から取り除かれる。
  - 存在しないID指定時は配列が変化しない。

#### T-UNIT-003：状態変更ロジック

- 対象要件：F-05（Must-be）
- 種別：ユニットテスト
- テストファイル：`src/tests/tasks.test.js`
- 観点：
  - 状態が「未着手 → 進行中 → 完了 → 保留 → 未着手」とローテーションする。
  - 不正な状態値の場合は安全側に倒す（デフォルト状態へ戻すなど）。

（※ 実際の `tasks.test.js` の細かい内容に合わせて、必要に応じて調整）

---

### 4.2 UI テスト（タスク追加・削除・編集）

#### T-UI-001：タスク追加 UI

- 対象要件：
  - F-01：タスク追加（Must-be）
  - F-02：タスク一覧表示（Must-be）
  - F-07：カテゴリ選択（One-dimensional）
  - F-09：メモ登録・表示（One-dimensional）※一部
- テストファイル：`src/tests/ui-add-task.test.jsx`
- 観点：
  1. タスク名を入力し、「追加」ボタンを押すと、一覧にカードが 1 件表示される。
  2. カードにタスク名・初期状態（未着手）が表示される。
  3. カテゴリ初期値（メインクエストなど）が表示される。
- Kano：Must-be ＋ One-dimensional

#### T-UI-002：タスク追加（空文字バリデーション）

- 対象要件：
  - F-01：タスク追加（Must-be）
  - F-11：入力バリデーション（Must-be）
- テストファイル：`src/tests/ui-add-empty-task.test.jsx`
- 観点：
  1. 空文字やスペースのみを入力して「追加」しても、カードが増えない。
  2. 既存タスクに影響がないこと。
- Kano：Must-be

#### T-UI-003：タスク削除 UI

- 対象要件：
  - F-04：タスク削除（Must-be）
  - F-13：削除取り消し（Undo）の情報表示との兼ね合い（One-dimensional）
- テストファイル：`src/tests/ui-delete-task.test.jsx`
- 観点：
  1. 「削除テスト」というタスクを追加。
  2. 当該カード上の「❌ 削除」ボタンをクリックすると、カード自体は一覧から消える。
  3. 一方で、「直前に削除したタスク:『削除テスト』」というテキストは残る（Undo 用）。
- Kano：Must-be（削除）＋ One-dimensional（Undo連携）

---

### 4.3 UI テスト（状態変更）

#### T-UI-004：状態変更ボタン

- 対象要件：
  - F-05：状態変更（Must-be）
- テストファイル：`src/tests/ui-status-change.test.jsx`
- 観点：
  1. 初期状態が「未着手」で表示されていること。
  2. 「🔄 状態変更」ボタンを押すごとに、「未着手 → 進行中 → 完了 → 保留 → 未着手」と表示が変わること。
- Kano：Must-be

---

### 4.4 UI テスト（並べ替え）

#### T-UI-005：状態昇順ソート

- 対象要件：
  - F-06：並べ替え（One-dimensional）
- テストファイル：`src/tests/ui-sort-task.test.jsx`
- 観点（一部）：
  1. 4種類の状態を持つタスクを用意する。
  2. 「状態の昇順（未着手 → 保留）」ボタン押下後、  
     **未着手 → 進行中 → 完了 → 保留** の順にカードが並ぶこと。
- Kano：One-dimensional

#### T-UI-006：状態降順ソート

- 対象要件：
  - F-06：並べ替え（One-dimensional）
- テストファイル：`src/tests/ui-sort-task.test.jsx`
- 観点（一部）：
  1. 昇順と同じ 4タスクを用意。
  2. 「状態の降順（保留 → 未着手）」ボタン押下後、  
     **保留 → 完了 → 進行中 → 未着手** の順になること。
- Kano：One-dimensional

#### T-UI-007：並べ替え解除 & ソート中の状態変更

- 対象要件：
  - F-06：並べ替え（One-dimensional）
  - F-05：状態変更（Must-be）
- テストファイル：`src/tests/ui-sort-task.test.jsx`
- 観点：
  1. 「並べ替え解除」で、追加順（タスク1 → タスク4）に戻ること。
  2. 昇順ソート中／降順ソート中に状態変更しても、カードの **並び順自体は変化しない** こと。
- Kano：One-dimensional（ソート）＋ Must-be（状態変更の整合性）

---

### 4.5 UI テスト（カテゴリ機能）

#### T-UI-008：カテゴリ絞り込み

- 対象要件：
  - F-07：カテゴリ選択（One-dimensional）
  - F-08：カテゴリ絞り込み（One-dimensional）
- テストファイル：`src/tests/ui-category-filter.test.jsx`
- 観点：
  1. 複数カテゴリ（メインクエスト／サブクエストなど）のタスクを追加。
  2. 絞り込みプルダウンで「メインクエスト」を選択すると、メインクエストのみが表示される。
  3. 「すべて」に戻すと、全タスクが再表示される。
- Kano：One-dimensional

---

### 4.6 UI テスト（入力バリデーション：最大長）

#### T-UI-009：タスク名の最大長 100文字

- 対象要件：
  - F-01：タスク追加（Must-be）
  - F-03：タスク編集（Must-be）
  - F-11：入力バリデーション（Must-be）
- テストファイル：`src/tests/ui-maxlength.test.jsx`
- 観点：
  1. ちょうど 100文字のタスク名は、そのまま追加されること。
  2. 101文字以上のタスク名を入力した場合、保存されるタスク名は先頭100文字に切り詰められていること。
- Kano：Must-be

---

### 4.7 UI テスト（localStorage 永続化）

#### T-UI-010：タスクの永続化

- 対象要件：
  - F-12：localStorage 永続化（Must-be）
- テストファイル：`src/tests/ui-storage.test.jsx`
- 観点：
  1. タスクを追加した状態でコンポーネントをアンマウント。
  2. 再マウントした際に、追加したタスクが復元されていること。
  3. 少なくともタスク名・状態・カテゴリが復元されることを確認。  
     （実装上はメモも含めて永続化されている）
- Kano：Must-be

---

### 4.8 UI テスト（編集）

#### T-UI-011：タスク名編集＋キャンセル

- 対象要件：
  - F-03：タスク編集（Must-be）
- テストファイル：`src/tests/ui-edit-task.test.jsx`
- 観点（ファイル内の複数テスト）：
  1. 編集 → 保存でタスク名が更新されること。
  2. 編集 → キャンセルでは元のタスク名のままであること。
  3. 編集モードでは「タスク名を編集…」入力欄と「💾 保存／↩️ キャンセル」ボタンが表示されること。
  4. 空文字で保存しようとした場合、タスク名は変わらないこと。
- Kano：Must-be

---

### 4.9 UI テスト（メモ機能）

#### T-UI-012：メモ編集

- 対象要件：
  - F-09：メモ登録・表示（One-dimensional）
  - F-10：メモ編集（One-dimensional）
- テストファイル：`src/tests/ui-memo-edit.test.jsx`
- 観点：
  1. 「メモ編集テスト」タスクを追加し、初期メモを設定しておく。
  2. 「✏️ 編集」ボタンを押し、カード内のメモ編集テキストエリア（`placeholder="メモを編集..."`）に新しいメモを入力。
  3. 「💾 保存」ボタンを押すと、カード上のメモ表示が新しい内容に更新されること。
- Kano：One-dimensional

---

### 4.10 UI テスト（削除取り消し：Undo）

#### T-UI-013：直前の削除を元に戻せる

- 対象要件：
  - F-04：タスク削除（Must-be）
  - F-13：削除取り消し（One-dimensional）
- テストファイル：`src/tests/ui-undo-delete.test.jsx`
- 観点：
  1. 「タスク1」「タスク2」を追加し、両方表示されていることを確認。
  2. 「タスク2」の「❌ 削除」ボタンを押す。
  3. 一覧から「タスク2」が消え、「直前に削除したタスク：『タスク2』」が表示され、「削除を取り消す」ボタンが有効になっていること。
  4. 「削除を取り消す」を押すと、「タスク1」「タスク2」の両方が再び一覧に表示されること。
- Kano：Must-be（削除）＋ One-dimensional（Undo）

#### T-UI-014：削除履歴がないときは Undo ボタンは押せない

- 対象要件：
  - F-13：削除取り消し（One-dimensional）
- テストファイル：`src/tests/ui-undo-delete.test.jsx`
- 観点：
  1. アプリ起動直後（削除操作を行っていない状態）では、「削除を取り消す」ボタンが `disabled` になっていること。
  2. 何度かタスクを追加しただけの状態でも、「削除を取り消す」は有効化されないこと。
- Kano：One-dimensional

---

### 4.11 環境確認用テスト

#### T-ENV-001：サンプルテスト

- 対象要件：特になし（環境確認用）
- テストファイル：`src/sample.test.js`
- 観点：
  - テストランナーが正常に動作しているかを確認するためのシンプルなテスト。

---

## 5. テストカバレッジと今後の追加候補

### 5.1 現状のカバレッジ状況

- Must-be 要件（F-01, 02, 03, 04, 05, 11, 12）
  - いずれも UI テスト＋一部ユニットテストでカバー済み。
- One-dimensional 要件（F-06, 07, 08, 09, 10, 13）
  - すべて UI テストでカバー済み。
- 非機能要件：
  - パフォーマンス、セキュリティなどは現状「手動テスト＋コードレビュー」での確認とする。

### 5.2 今後のテスト追加候補

- パフォーマンス系テスト（大量タスク時のレスポンス測定）
- アクセシビリティ系テスト（キーボード操作、ARIA属性など）
- E2E テスト（将来的に Playwright 等によるブラウザ自動操作を導入する場合）

